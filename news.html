<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Latest News and Events at Crown Heights Academy.">
    <title>News & Events | Crown Heights Academy</title>
    <!-- Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Outfit:wght@500;700&display=swap"
        rel="stylesheet">
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Styles -->
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <!-- Navigation (Same as index) -->
    <nav class="navbar" style="background: var(--dark-purple);">
        <div class="container nav-container">
            <a href="index.html" class="logo">
                <img src="images/logo.png" alt="Crown Heights Academy" style="height: 45px; margin-right: 10px;">
                Crown Heights
            </a>
            <div class="menu-toggle"><i class="fa-solid fa-bars"></i></div>
            <ul class="nav-links">
                <li><a href="index.html" class="nav-link">Home</a></li>
                <li><a href="about.html" class="nav-link">About Us</a></li>
                <li><a href="academics.html" class="nav-link">Academics</a></li>
                <li><a href="admissions.html" class="nav-link">Admissions</a></li>
                <li><a href="news.html" class="nav-link" style="color: var(--primary-yellow);">News & Events</a></li>
                <li><a href="gallery.html" class="nav-link">Gallery</a></li>
                <li><a href="contact.html" class="btn btn-secondary text-dark">Contact Us</a></li>
                <li><button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                        <i class="fa-solid fa-moon"></i>
                    </button></li>
            </ul>
        </div>
    </nav>

    <header class="section-padding text-center" style="background: var(--light-purple); padding-top: 150px;">
        <div class="container">
            <span class="text-purple" style="font-weight: 600; text-transform: uppercase;">Latest Updates</span>
            <h1 style="font-size: 3rem; margin-top: 10px;">News & Events</h1>
        </div>
    </header>

    <section class="section-padding">
        <div class="container">
            <div class="news-grid">

                <!-- Blog Post 1 -->
                <div class="glass-card" style="padding: 0; overflow: hidden; background: white; position: relative;"
                    data-event-date="2026-03-15">
                    <div class="countdown-badge"></div>
                    <img src="images/event-sports.png" style="width: 100%; height: 200px; object-fit: cover;">
                    <div style="padding: 25px;">
                        <span class="text-purple" style="font-size: 0.85rem; font-weight: 600;">March 15, 2026</span>
                        <h3 style="margin: 10px 0;">Inter-House Sports Champions</h3>
                        <p class="text-muted">Red House takes the trophy this year after a stunning relay finish!</p>
                        <a href="events/event-sports.html" class="text-purple"
                            style="font-weight: 600; display: inline-block; margin-top: 15px;">Read More <i
                                class="fa-solid fa-arrow-right"></i></a>
                    </div>
                </div>
                <!-- Blog Post 2 -->
                <div class="glass-card" style="padding: 0; overflow: hidden; background: white; position: relative;"
                    data-event-date="2026-04-02">
                    <div class="countdown-badge"></div>
                    <img src="images/event-science.jpg" style="width: 100%; height: 200px; object-fit: cover;">
                    <div style="padding: 25px;">
                        <span class="text-purple" style="font-size: 0.85rem; font-weight: 600;">April 02, 2026</span>
                        <h3 style="margin: 10px 0;">Science Fair Winners</h3>
                        <p class="text-muted">Our young scientists displayed amazing projects from robotics to biology.
                        </p>
                        <a href="events/event-science.html" class="text-purple"
                            style="font-weight: 600; display: inline-block; margin-top: 15px;">Read More <i
                                class="fa-solid fa-arrow-right"></i></a>
                    </div>
                </div>
                <!-- Blog Post 3 -->
                <div class="glass-card" style="padding: 0; overflow: hidden; background: white; position: relative;"
                    data-event-date="2026-05-20">
                    <div class="countdown-badge"></div>
                    <img src="images/event-art.jpg" style="width: 100%; height: 200px; object-fit: cover;">
                    <div style="padding: 25px;">
                        <span class="text-purple" style="font-size: 0.85rem; font-weight: 600;">May 20, 2026</span>
                        <h3 style="margin: 10px 0;">Colors of Creativity</h3>
                        <p class="text-muted">The art exhibition was a huge success, showcasing student talent.</p>
                        <a href="events/event-art.html" class="text-purple"
                            style="font-weight: 600; display: inline-block; margin-top: 15px;">Read More <i
                                class="fa-solid fa-arrow-right"></i></a>
                    </div>
                </div>
                <!-- Blog Post 4 -->
                <div class="glass-card" style="padding: 0; overflow: hidden; background: white; position: relative;"
                    data-event-date="2026-06-10">
                    <div class="countdown-badge"></div>
                    <img src="images/event-music.jpg" style="width: 100%; height: 200px; object-fit: cover;">
                    <div style="padding: 25px;">
                        <span class="text-purple" style="font-size: 0.85rem; font-weight: 600;">June 10, 2026</span>
                        <h3 style="margin: 10px 0;">Music Day Concert</h3>
                        <p class="text-muted">Join us for an evening of melody and rhythm with the school choir.</p>
                    </div>
                </div>
            </div>

            <!-- Dynamic Articles from Admin Panel -->
            <div id="dynamic-articles" style="margin-top: 40px;"></div>
        </div>
    </section>

    <!-- Footer -->
    <footer style="background: var(--text-dark); color: white; padding-top: 50px; padding-bottom: 30px;">
        <div class="container text-center">
            <a href="admin.html"><img src="images/logo.png" alt="Crown Heights Academy"
                    style="height: 80px; margin-bottom: 15px;"></a>
            <h3 style="color: var(--primary-yellow); margin-bottom: 10px;">Crown Heights Academy</h3>
            <p style="color: #aaa;">&copy; 2026. All Rights Reserved.</p>
        </div>
    </footer>
    <script src="js/main.js"></script>
    <script type="module" src="js/admin.js"></script>
    <script type="module">
        import { db, collection, getDocs, query, orderBy } from './js/firebase-config.js';

        // Render dynamic articles on news page
        document.addEventListener('DOMContentLoaded', async function () {
            const container = document.getElementById('dynamic-articles');
            if (!container) return;

            let articles = [];

            // Try Firebase first
            try {
                const q = query(collection(db, "articles"), orderBy("date", "desc"));
                const querySnapshot = await getDocs(q);
                querySnapshot.forEach((doc) => {
                    articles.push({ id: doc.id, ...doc.data() });
                });
            } catch (e) {
                console.warn("Firebase fetch failed, trying local storage", e);
                // Fallback to localStorage (compatible with window.crownheightsArticles if it exists)
                if (window.crownheightsArticles) {
                    articles = await window.crownheightsArticles.getAll();
                }
            }

            if (articles.length === 0) return;

            let html = '<h2 style="margin-bottom: 25px; color: var(--dark-purple);">Latest Announcements</h2>';
            html += '<div class="news-grid">';

            articles.forEach(article => {
                const imageHtml = article.image
                    ? `<img src="${article.image}" style="width: 100%; height: 200px; object-fit: cover;" alt="${article.title}">`
                    : `<div style="width: 100%; height: 200px; background: var(--bg-gradient); display: flex; align-items: center; justify-content: center;">
                        <i class="fa-solid fa-newspaper text-white" style="font-size: 3rem;"></i>
                       </div>`;

                // Safe formatting
                const dateStr = window.crownheightsArticles ? window.crownheightsArticles.formatDate(article.date) : article.date;

                html += `
                    <div class="glass-card animate-on-scroll" style="padding: 0; overflow: hidden; background: white; position: relative;" data-event-date="${article.date}">
                        <div class="countdown-badge"></div>
                        ${imageHtml}
                        <div style="padding: 25px;">
                            <span class="text-purple" style="font-size: 0.85rem; font-weight: 600;">${dateStr}</span>
                            <h3 style="margin: 10px 0;">${article.title}</h3>
                            <p class="text-muted">${article.summary}</p>
                            <a href="article.html?id=${article.id}" class="text-purple" style="font-weight: 600; display: inline-block; margin-top: 15px;">Read More <i class="fa-solid fa-arrow-right"></i></a>
                        </div>
                    </div>
                `;
            });

            html += '</div>';
            container.innerHTML = html;

            // Re-initialize countdowns and animations for new items
            if (window.initEventCountdowns) window.initEventCountdowns();

            // Trigger animation observer for new elements
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) entry.target.classList.add('in-view');
                });
            }, { threshold: 0.1 });

            container.querySelectorAll('.animate-on-scroll').forEach(el => observer.observe(el));
        });
    </script>
</body>

</html>